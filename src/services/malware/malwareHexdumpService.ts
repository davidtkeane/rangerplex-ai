import { codeExecutionService } from '../codeExecutionService';

export class MalwareHexdumpService {
    /**
     * Display a canonical hex dump of the file (first N lines)
     * Shows Offset | Hex | ASCII
     */
    async getHexdump(filePath: string, lines: number = 20): Promise<void> {
        // hexdump -C is standard on macOS and Linux
        // It produces the canonical hex+ASCII output we want
        const command = `
echo "ðŸ”¢ MALWARE HEX DUMP"
echo "==================="
echo "Target: ${filePath}"
echo "Lines: ${lines}"
echo "-------------------"
hexdump -C "${filePath}" | head -n ${lines}
echo "-------------------"
echo "(Output truncated to first ${lines} lines)"
echo "==================="
`;
        await codeExecutionService.executeCode(command, 'bash');
    }
}

export const malwareHexdumpService = new MalwareHexdumpService();
