import { codeExecutionService } from '../codeExecutionService';

export class MalwareFileInfoService {
    /**
     * Get detailed file information using 'file' and 'stat' commands
     * Identifies file type, architecture, and basic metadata
     */
    async getFileInfo(filePath: string): Promise<void> {
        const command = `
echo "ðŸ“„ MALWARE FILE ANALYSIS"
echo "========================"
echo "Target: ${filePath}"
echo ""
echo "[Basic Info]"
ls -lh "${filePath}"
echo ""
echo "[File Type (Magic Bytes)]"
file "${filePath}"
echo ""
echo "[Permissions & Dates]"
stat -x "${filePath}" 2>/dev/null || stat "${filePath}"
echo "========================"
`;
        await codeExecutionService.executeCode(command, 'bash');
    }
}

export const malwareFileInfoService = new MalwareFileInfoService();
